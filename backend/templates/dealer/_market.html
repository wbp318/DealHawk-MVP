{% if trends.get("error") %}
<div class="alert alert-error">Market data temporarily unavailable. Please try again later.</div>
{% else %}
<h3>{{ make }} {{ model }} Market Trends</h3>

<div class="cards">
    <div class="card">
        <div class="card-title">Days Supply</div>
        <div class="card-value">{{ trends.days_supply }}</div>
        <p>Industry avg: {{ trends.industry_avg_days_supply }}</p>
    </div>

    <div class="card">
        <div class="card-title">Supply Level</div>
        <div class="card-value">
            <span class="status-badge status-{{ 'active' if trends.supply_level == 'oversupplied' else 'inactive' if trends.supply_level == 'undersupplied' else 'active' }}">
                {{ trends.supply_level|capitalize }}
            </span>
        </div>
    </div>

    <div class="card">
        <div class="card-title">Price Trend</div>
        <div class="card-value">{{ trends.price_trend|capitalize }}</div>
    </div>

    <div class="card">
        <div class="card-title">Active Incentives</div>
        <div class="card-value">{{ trends.active_incentive_count }}</div>
        <p>Total value: ${{ "{:,.0f}".format(trends.total_incentive_value) }}</p>
    </div>
</div>

<div class="detail-table">
    <div class="detail-row">
        <span class="detail-label">Supply Ratio</span>
        <span class="detail-value">{{ trends.supply_ratio }}x</span>
    </div>
    <div class="detail-row">
        <span class="detail-label">Inventory Level</span>
        <span class="detail-value">{{ trends.inventory_level|capitalize }}</span>
    </div>
    <div class="detail-row">
        <span class="detail-label">Data Source</span>
        <span class="detail-value">{{ trends.source }}</span>
    </div>
    <div class="detail-row">
        <span class="detail-label">As Of</span>
        <span class="detail-value">{{ trends.as_of }}</span>
    </div>
</div>
{% endif %}
